<!DOCTYPE html>
<html lang="en">
<head>
  <title>User Concern Selection</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">


  <script src="../js/jquery/jquery.min.js"></script>
  <script src="../js/bootstrap/bootstrap.bundle.min.js"></script>

  <script src="../js/util.js"></script>
  <script src="../js/settings.js"></script>
  <script src="../js/query.js"></script>
  <script src="../js/definition.js"></script>


  <link rel="stylesheet" href="../css/bootstrap/bootstrap.min.css">
  <link rel="stylesheet" href="../css/query.css">
  <link rel="stylesheet" href="../css/definition.css">
</head>
<body>

<script>
  let query;

  let el_type;
  let el_parameters;

  let el_query_pattern;
  let el_query;

  let el_limits;
  let el_metrics;
  let el_conditions_metric;
  let el_conditions_limit;
  let el_conditions_value;

  let el_analysis_method;

  let el_loadtest_domain;
  let el_loadtest_load;
  let el_loadtest_ramp_up;
  let el_loadtest_ramp_down;

  let el_jmeter_experiment;
  let el_jmeter_properties;

  let el_user_concern;

  $(document).ready(function() {
    query = new Query($("#query"), $(".badge-pool"));

    el_type = $("#filter_type");
    el_parameters = $("#filter_parameters");

    el_query_pattern = $("#query_pattern");
    el_query = $("#query");

    el_limits = $("#parameter_limits");
    el_metrics = $("#parameter_metrics");
    el_conditions_metric = $("#parameter_conditions_metric");
    el_conditions_limit = $("#parameter_conditions_limit");
    el_conditions_value = $("#parameter_conditions_value");

    el_analysis_method = $("#analysis_method");

    el_loadtest_domain = $("#loadtest_domain");
    el_loadtest_load = $("#loadtest_load");
    el_loadtest_ramp_up = $("#loadtest_ramp_up");
    el_loadtest_ramp_down = $("#loadtest_ramp_down");

    el_jmeter_experiment = $("#jmeter_experiment");
    el_jmeter_properties = $("#jmeter_properties");

    el_user_concern = $("#user_concern");

    $("#jmeter_experiment").val(JMETER.simple);
    $('[data-toggle="tooltip"]').tooltip();

    fillSelect("query_pattern", Object.keys(QUERIES));
    loadModel();
    updateUI();

    $("#main-carousel").find("input, select").each(function() {
       $(this).on("change", function()
       {
           saveModel();
           updateUI();
       });

       $(this).on("input", function()
       {
           saveModel();
           updateUI();
       });
   });
});
</script>

<div class="main-container-decoration"></div>
<div class="main-container">
  <div id="main-carousel" class="carousel slide" data-ride="carousel" data-interval="false">

    <ul class="carousel-indicators">
      <li data-target="#main-carousel" data-slide-to="0" class="active" id="indicator-0">Start</li>
      <li data-target="#main-carousel" data-slide-to="1" id="indicator-1">Filters</li>
      <li data-target="#main-carousel" data-slide-to="2" id="indicator-2">Query</li>
      <li data-target="#main-carousel" data-slide-to="3" id="indicator-3">Analysis Method</li>
      <li data-target="#main-carousel" data-slide-to="4" id="indicator-4">Analysis Configuration</li>
      <li data-target="#main-carousel" data-slide-to="5" id="indicator-5">Finish</li>
    </ul>

    <div class="carousel-inner">

      <div class="carousel-item active">
        <h1>User Concern Definition</h1>
        <hr>
        <p class="p-section">
          This is the User Interface to configure a User Concern which helps you
          to configure an analysis and create automatic performance Reports.
          In the following steps you will be asked to fill out settings.
          This helps us to define a useful User Concern.
          If you are ready, then proceed by either clicking the navigation arrows
          or using the control buttons on the bottom.
        </p>
      </div>

      <div class="carousel-item">
        <h1>Filters</h1>
        <hr>

        <div class="p-section">

          <h4>Are you a performance analysis expert?</h4>
          <hr>

          <p>If you check this option you will see all available configurations.</p>

          <div class="custom-control custom-checkbox">
            <input type="checkbox" class="custom-control-input" id="expert" value="true">
            <label class="custom-control-label" for="expert" data-toggle="tooltip" data-placement="right"
                   title="Experts will have more options to configure a analysis.">
              Expert
            </label>
          </div>

          <div class="filler"></div>

          <h4>Do you want to perform an analysis or generate a report from existing data?</h4>
          <hr>

          <div class="input-group">

            <div id="filter_type">
              <div class="custom-control custom-radio">
                <input type="radio" class="custom-control-input" id="filter_type_Analysis" name="filter_type" value="Analysis" checked>
                <label class="custom-control-label" for="filter_type_Analysis" data-toggle="tooltip" data-placement="right"
                       title="You can configure an analysis experiment.">
                  Analysis
                </label>
              </div>

              <div class="custom-control custom-radio">
                <input type="radio" class="custom-control-input" id="filter_type_Report" name="filter_type" value="Report">
                <label class="custom-control-label" for="filter_type_Report" data-toggle="tooltip" data-placement="right"
                       title="If you only want to generate an report, ....">
                  Report
                </label>
              </div>
            </div>

          </div>
        </div>

        <div class="p-section">

          <div id="filter_parameters">

            <h4>Which parameters should your concern cover?</h4>
            <hr>

            <div class="input-group">

              <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input" id="filter_parameter_Limits" value="Limits">
                <label class="custom-control-label" for="filter_parameter_Limits">Limits</label>
              </div>

              <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input" id="filter_parameter_Metrics" value="Metrics">
                <label class="custom-control-label" for="filter_parameter_Metrics">Metrics</label>
              </div>

              <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input" id="filter_parameter_Conditions" value="Conditions">
                <label class="custom-control-label" for="filter_parameter_Conditions">Conditions</label>
              </div>

              <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input" id="filter_parameter_Services" value="Services">
                <label class="custom-control-label" for="filter_parameter_Services">Services</label>
              </div>

              <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input" id="filter_parameter_Timestamps" value="Timestamps">
                <label class="custom-control-label" for="filter_parameter_Timestamps">Timestamps</label>
              </div>

              <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input" id="filter_parameter_Status" value="Status">
                <label class="custom-control-label" for="filter_parameter_Status">Status</label>
              </div>
            </div>
          </div>

        </div>
      </div>

      <div class="carousel-item">

        <div id="query-configuration">
          <h1>Query</h1>
          <hr>

          <div class="p-section">

            <h4>Choose a query that suits your needs the most?</h4>
            <hr>

            <select class="custom-select" id="query_pattern">
              <option value="" selected disabled>Select a query.</option>
            </select>

            <div class="query-wrapper">
              <div id="query"></div>
              <div id="badge-pool" class="d-inline-block badge-pool" ondrop="dropPool(event);" ondragover="allowDrop(event);"></div>
            </div>
          </div>
        </div>

        <div id="parameter-selection">

          <h1>Parameters</h1>
          <hr>

          <div class="p-section">

            <ul class="nav nav-tabs">
                <li class="nav-item"><a class="nav-link" data-toggle="tab" id="tab-Limits" href="#limits">Limits</a></li>
                <li class="nav-item"><a class="nav-link" data-toggle="tab" id="tab-Metrics" href="#metrics">Metrics</a></li>
                <li class="nav-item"><a class="nav-link" data-toggle="tab" id="tab-Conditions" href="#conditions">Conditions</a></li>
                <li class="nav-item"><a class="nav-link" data-toggle="tab" id="tab-Services" href="#services">Services</a></li>
                <li class="nav-item"><a class="nav-link" data-toggle="tab" id="tab-Timestamps" href="#timestamps">Timestamps</a></li>
                <li class="nav-item"><a class="nav-link" data-toggle="tab" id="tab-Status" href="#status">Status</a></li>
            </ul>

            <div class="tab-content">
              <div id="limits" class="tab-pane">
                <select class="custom-select" id="parameter_limits">
                  <option value="" selected disabled>Select a limit.</option>
                  <option value="minimum">minimum</option>
                  <option value="average">average</option>
                  <option value="maximum">maximum</option>
                </select>
              </div>
              <div id="metrics" class="tab-pane">
                <select class="custom-select" id="parameter_metrics">
                  <option value="" selected disabled>Select a metric.</option>
                  <option value="Latency">Latency</option>
                  <option value="Response Time">Response Time</option>
                  <option value="number of users">number of users</option>
                </select>
              </div>
              <div id="conditions" class="tab-pane">
                <select class="custom-select" id="parameter_conditions_metric">
                  <option value="" selected disabled>Select a metric for the condition.</option>
                  <option value="Latency">Latency</option>
                </select>
                <select class="custom-select" id="parameter_conditions_limit">
                  <option value="" selected disabled>Select a limit for the condition.</option>
                  <option value="is below">is below</option>
                  <option value="is equal to">is equal to</option>
                </select>
                <select class="custom-select" id="parameter_conditions_value">
                  <option value="" selected disabled>Select a value for the condition.</option>
                  <option value="0">0</option>
                  <option value="1">1</option>
                  <option value="2">2</option>
                  <option value="3">3</option>
                </select>
              </div>
              <div id="services" class="tab-pane">
                <select class="custom-select" id="parameter_services">
                </select>
                <div class="custom-file">
                  <input type="file" class="custom-file-input" id="parameter_services_docker">
                  <label class="custom-file-label" for="parameter_services_docker">Choose Docker file...</label>
                </div>
              </div>
              <div id="timestamps" class="tab-pane">
                <select class="custom-select" id="parameter_timestamps_value">
                  <option value="" selected disabled>Select a timestamp value.</option>
                  <option value="0">0</option>
                  <option value="1">1</option>
                  <option value="2">2</option>
                  <option value="3">3</option>
                </select>
                <select class="custom-select" id="parameter_timestamps_unit">
                  <option value="" selected disabled>Select a timestamp unit.</option>
                  <option value="ms">ms</option>
                  <option value="s">s</option>
                  <option value="m">m</option>
                </select>
              </div>
              <div id="status" class="tab-pane">
                <select class="custom-select" id="parameter_status">
                  <option value="" selected disabled>Select a status.</option>
                  <option value="offline">offline</option>
                  <option value="online">online</option>
                </select>
              </div>
            </div>
          </div>
        </div>

      </div>

      <div class="carousel-item">

        <div id="analysis-method">
          <h1>Analysis Method</h1>
          <hr>

          <div class="p-section">

            <h4>Select a Analysis Method.</h4>
            <hr>
            <br>

            <select class="custom-select" id="analysis_method">
              <option value="" selected disabled>Select a analysis method.</option>
              <option value="JMeter">JMeter</option>
            </select>

          </div>

        </div>

      </div>

      <div class="carousel-item">

        <div id="analysis-configuration">
          <h1>Analysis Configuration</h1>
          <hr>

          <div class="p-section">

            <div id="loadtest-configuration">

              <h3>Loadtest Configuration</h3>
              <hr>

              <div class="form-group">

                <div class="p-section">

                  <h4>Select the location your system.</h4>
                  <hr>

                  <input type="url" id="loadtest_domain" placeholder="www.example.com"/>

                  <div class="filler"></div>

                  <h4>Specify the loadtest values.</h4>
                  <hr>

                  <label>
                    Load (number of users) *:<br>
                    <select class="custom-select d-inline-block" id="loadtest_load">
                      <option value="" selected disabled>Select the amount of load.</option>
                      <option value="0">0</option>
                      <option value="1">1</option>
                      <option value="2">2</option>
                      <option value="10">10</option>
                      <option value="100">100</option>
                    </select>
                  </label>

                  <label>
                    Ramp up time (s):<br>
                    <input type="number" id="loadtest_ramp_up" placeholder="1">
                  </label>

                  <label>
                    Ramp down time (s):<br>
                    <input type="number" id="loadtest_ramp_down" placeholder="1">
                  </label>

                </div>

              </div>

              <div id="jmeter-configuration">

                <h3>JMeter Configuration</h3>
                <hr>

                <div class="p-section">

                  <h4>Analysis Experiment</h4>
                  <hr>

                  <div class="p-section">

                    <div class="form-group d-inline-block">
                      <label for="jmeter-experiment">JMeter experiment configuration:</label><br>
                      <textarea class="form-control" rows="10" cols="100" id="jmeter_experiment" readonly></textarea>
                    </div>

                  </div>

                  <h4>Experiment Properties</h4>
                  <hr>

                  <div class="p-section">

                    <div class="form-group d-inline-block">
                      <label for="jmeter-properties">JMeter experiment properties:</label><br>
                      <textarea class="form-control" rows="10" cols="100" id="jmeter_properties" readonly></textarea>
                    </div>

                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="carousel-item">
        <h1>Closing Steps</h1>
        <hr>

        <div class="p-section">
          <h4>Analysis</h4>
          <hr>

          <p>
            JMeter will be your analysis tool. Download the following two files, then proceed with the next steps.<br>
            <button class="d-inline-block btn-primary" onclick="download('#jmeter_experiment', 'jmeter_experiment.jmx')">Download JMeter Test File</button>
            <button class="d-inline-block btn-primary" onclick="download('#jmeter_properties', 'jmeter_properties.prop')">Download JMeter Properties File</button>
          </p>

          <p>
            If you have downloaded the two files you are ready to perform a loadtest evaluation of your system.
            Open a terminal, then type one of the following commands into the terminal (they have the same effect).
            <pre>
            <code>
              jmeter -p [...] -t [...] -l [...]

              jmeter --propfile [...] -testfile [...] -logfile [...]
            </code>
            </pre>
          </p>

          <h4>User Concern</h4>
          <hr>

          <p>
            For the last step you have to get the User Concern by downloading it.
            If you don't mind to keep your User Concern, you can continue by clicking <a id="redirect" href="">here</a>.
            <br>
            <button class="btn-primary" onclick="download('#user_concern', 'user_concern.json')">Download the User Concern</button>
            <textarea id="user_concern" class="d-none"></textarea>
          </p>
        </div>

      </div>

    </div>

    <div class="carousel-control">
      <a class="carousel-control-prev carousel-control-icon" href="#main-carousel" data-slide="prev">
        <span class="carousel-control-prev-icon"></span>
      </a>
      <a class="carousel-control-next carousel-control-icon" href="#main-carousel" data-slide="next">
        <span class="carousel-control-next-icon"></span>
      </a>
    </div>

  </div>
</div>

</body>
</html>